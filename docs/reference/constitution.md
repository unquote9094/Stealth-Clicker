# 🟢 AGENT CONSTITUTION (핵심 규칙)

> **SYSTEM**: 이 규칙은 자동화 스크립트로 강제됩니다.

## 1. 언어

- **모든 답변/주석/커밋**: 한국어 (변수명, 기술용어 제외)
- **상세 규칙**: GEMINI.md 참조

## 2. 문서화 (자동 검증)

| 문서 | 검증 시점 | 검증 도구 |
|---|---|---|
| `docs/TODO.md` | 커밋 시 | `finish-task.js` |
| `docs/버그해결기록.md` | 버그 커밋 시 | `finish-task.js` |

> **Note**: 수동으로 기억할 필요 없음. 스크립트가 누락 시 거부함.

> [!IMPORTANT]
> **버그 번호 = 이슈 번호**: 버그해결기록의 `## 버그 #N`은 반드시 GitHub 이슈 번호와 동일하게 작성.
> 예: 이슈 #20 → `## 버그 #20: 제목`

## 3. 테스트 (자동 검증)

- `npm test` 통과 필수
- 검증 시점: `finish-task.js` 및 `pre-commit hook`
- 실패 시 커밋 거부됨

## 4. 이슈 Close 규칙

> [!CAUTION]
> **`Closes #N`은 마지막 커밋에만 사용!**

| 상황 | 커밋 메시지 |
|------|-------------|
| 개발 도중 | `fix: ABC 구현 (#20)` ← 이슈 열린 상태 유지 |
| 최종 완료 | `fix: 최종 수정 (Closes #20)` ← 이슈 Close됨 |

- **테스트 완료 후에만** `Closes` 사용
- **사용자 테스트 성공 확인 후에만** 버그해결기록 업데이트 및 커밋
- 후속 버그 발견 시 **별도 이슈** 생성 권장

## 5. 작업 시작 (권장)

```bash
npm run start-task -- <type> "제목"
# Types: bug, feat, enhance, fix
```

> **Note**: 선택 사항. 안 해도 작업 가능하지만, 이슈 자동 생성/추적을 원하면 실행 권장.

## 6. 모듈화 태그

`src/*.js` 수정 시 커밋 메시지에 태그 필수:

| 태그 | 의미 |
|---|---|
| `[MOD]` | 모듈화 완료 |
| `[RAW]` | 의도적으로 모듈화 안 함 |
| `[N/A]` | 해당 없음 |

---

## 워크플로우 요약

```
1. 작업 시작 → start-task 실행 (선택)
2. 코드 작업
3. 커밋 → finish-task 실행 (필수)
   └→ 자동 검증: TODO, 버그기록, 테스트, 태그
4. 완료
```

> **SYSTEM MESSAGE**: 규칙 위반 시 `process.exit(1)`.
